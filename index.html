<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>M·ª•c Ti√™u H·ªçc T·∫≠p</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-image: url('mid.png');
      background-size: cover;
      background-position: center;
      color: #fff;
      text-align: center;
    }
    .container {
      background: rgba(0, 0, 0, 0.6);
      padding: 20px;
      max-width: 700px;
      margin: 40px auto;
      border-radius: 15px;
    }
    img {
      width: 100%;
      border-radius: 15px;
    }
    button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background-color: #4caf50;
      color: white;
    }
    #progress {
      margin-top: 20px;
      font-size: 18px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üéØ M·ª•c ti√™u h·ªçc t·∫≠p m·ªói ng√†y</h1>
    <img src="Xiaomi-Mi-11-Ultra.jpg" alt="Ph·∫ßn th∆∞·ªüng">
    <p id="progress">ƒêi·ªÉm hi·ªán t·∫°i: 0 / 3120</p>
    <div id="daily-buttons">
      <button onclick="diemDanh()">ƒêi·ªÉm danh h√¥m nay (+10)</button><br>
      <button onclick="congDiem('toan', 10)">H·ªçc To√°n (+10)</button>
      <button onclick="congDiem('ly', 10)">H·ªçc L√Ω (+10)</button>
      <button onclick="congDiem('hoa', 10)">H·ªçc H√≥a (+10)</button>
      <button onclick="congDiem('anh', 10)">H·ªçc Ti·∫øng Anh (+10)</button><br>
      <button onclick="congDiem('on', 30)">√în t·∫≠p ki·∫øn th·ª©c (+30)</button>
    </div>
    <div style="margin-top: 20px;">
      <label>‚è∞ ƒê·∫∑t gi·ªù nh·∫Øc h·ªçc: <input type="time" id="reminderTime"> <button onclick="setReminder()">L∆∞u</button></label>
    </div>
  </div>

  <script>
    const TOTAL_DAYS = 312;
    const TOTAL_SCORE = TOTAL_DAYS * 100; // ƒëi·ªÉm t·ªëi ƒëa n·∫øu ho√†n th√†nh ƒë·∫ßy ƒë·ªß m·ªói ng√†y
    let diem = parseInt(localStorage.getItem("diem")) || 0;
    let today = new Date().toISOString().split('T')[0];
    let done = JSON.parse(localStorage.getItem("done")) || {};
    let reminderTime = localStorage.getItem("reminderTime") || "";

    // Auto tr·ª´ ƒëi·ªÉm n·∫øu h√¥m tr∆∞·ªõc ch∆∞a l√†m ƒë·ªß
    let lastCheck = localStorage.getItem("lastCheck") || "";
    if (lastCheck && lastCheck !== today) {
      const missed = JSON.parse(localStorage.getItem("done"))[lastCheck];
      if (missed) {
        const tasks = ['on', 'toan', 'ly', 'hoa', 'anh', 'diemdanh'];
        tasks.forEach(task => {
          if (!missed[task]) {
            const minus = (task === 'on') ? 30 : 10;
            diem -= minus;
          }
        });
        diem = Math.max(0, diem);
        localStorage.setItem("diem", diem);
      }
    }
    localStorage.setItem("lastCheck", today);

    function updateProgress() {
      document.getElementById("progress").innerText = `ƒêi·ªÉm hi·ªán t·∫°i: ${diem} / ${TOTAL_SCORE}`;
      if (diem >= TOTAL_SCORE) alert("üéâ Ch√∫c m·ª´ng b·∫°n ƒë√£ ho√†n th√†nh m·ª•c ti√™u v√† gi√†nh ƒë∆∞·ª£c Xiaomi Mi 11 Ultra!");
    }

    function congDiem(task, amount) {
      let doneToday = done[today] || {};
      if (doneToday[task]) return alert("B·∫°n ƒë√£ ho√†n th√†nh nhi·ªám v·ª• n√†y h√¥m nay!");
      diem += amount;
      doneToday[task] = true;
      done[today] = doneToday;
      localStorage.setItem("diem", diem);
      localStorage.setItem("done", JSON.stringify(done));
      updateProgress();
    }

    function diemDanh() {
      congDiem("diemdanh", 10);
    }

    function setReminder() {
      const time = document.getElementById("reminderTime").value;
      if (!time) return alert("H√£y ch·ªçn gi·ªù tr∆∞·ªõc!");
      localStorage.setItem("reminderTime", time);
      alert("ƒê√£ l∆∞u gi·ªù nh·∫Øc h·ªçc l√∫c " + time);
    }

    // Notification reminder
    function startReminderCheck() {
      if (!("Notification" in window)) return;
      Notification.requestPermission();
      setInterval(() => {
        const t = localStorage.getItem("reminderTime");
        if (!t) return;
        const now = new Date();
        const nowStr = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0');
        if (nowStr === t) {
          new Notification("‚è∞ ƒê·∫øn gi·ªù h·ªçc r·ªìi! H√£y ho√†n th√†nh m·ª•c ti√™u h√¥m nay nh√©.");
        }
      }, 60000); // ki·ªÉm tra m·ªói ph√∫t
    }

    updateProgress();
    startReminderCheck();
  </script>
</body>
</html>
